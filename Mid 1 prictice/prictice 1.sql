-- SUTABDI'S PROBLEM
--STUDENT TABLE
CREATE TABLE STUDENT_TABLE(STUDENT_ID VARCHAR2(4),STUDENT_NAME VARCHAR2(30));

INSERT INTO STUDENT_TABLE VALUES ('7007','JAMES BOND');
INSERT INTO STUDENT_TABLE VALUES ('1313','SUSAN BROWH');
INSERT INTO STUDENT_TABLE VALUES ('5050','SUSAN SMITH');
INSERT INTO STUDENT_TABLE VALUES ('8989','MAGAN BLACK');
--MODIFY THE PRIMARY KEY

ALTER TABLE STUDENT_TABLE ADD CONSTRAINT STUDENT_PK PRIMARY KEY (STUDENT_ID);

--COURSE TABLE 
CREATE TABLE COURSE_TABLE(COURSE_ID VARCHAR2(7), COUR_NAME VARCHAR2(30), NOOFPTS NUMBER);

INSERT INTO COURSE_TABLE VALUES ('COMP302','DATA SYSTEMS',15);
INSERT INTO COURSE_TABLE VALUES ('COMP203','COMPUTER ORGANIZATION',22);
INSERT INTO COURSE_TABLE VALUES ('COMP206','PROGRAM AND DATA STRUCTURES',22);
INSERT INTO COURSE_TABLE VALUES ('COMP442','ISSUES IN DATABASE',15);

ALTER TABLE COURSE_NAME ADD CONSTRAINT COURSE_PK PRIMARY KEY (COURSE_ID);
--ENROLLED_TABLE
CREATE TABLE ENROLLED_TABLE ( STUDENT_ID VARCHAR2(4),COURSE_ID VARCHAR2(7), GRADE VARCHAR2(2),
CONSTRAINT STUDENT_FK FOREIGN KEY (STUDENT_ID) REFERENCES STUDENT_TABLE,
CONSTRAINT COURSE_FK FOREIGN KEY (COURSE_ID) REFERENCES COURSE_TABLE);

INSERT INTO ENROLLED_TABLE VALUES ('7007','COMP203','A+');
INSERT INTO ENROLLED_TABLE VALUES ('7007','COMP206','A+');
INSERT INTO ENROLLED_TABLE VALUES ('7007','COMP302','A+');
INSERT INTO ENROLLED_TABLE VALUES ('7007','COMP442','');
INSERT INTO ENROLLED_TABLE VALUES ('1313','COMP203','A');
INSERT INTO ENROLLED_TABLE VALUES ('1313','COMP302','B+');
INSERT INTO ENROLLED_TABLE VALUES ('5050','COMP203','C+');
INSERT INTO ENROLLED_TABLE VALUES ('1313','COMP442','');
INSERT INTO ENROLLED_TABLE VALUES ('1313','COMP442',NULL);

-- WRITE A RELATIONAL ALGREBRAIC EXPRESSION THAT WILL RETURN THE STUDENT NAMES ALONG WITH THE COURSE NAME WHICH THEY HAVE ENROLLED.
SELECT STUDENT_NAME,COUR_NAME
FROM STUDENT_TABLE NATURAL JOIN ENROLLED_TABLE NATURAL JOIN COURSE_TABLE;

--write a sql query that returns the name of the course which is not enrolled by any students.
SELECT COURSE_TABLE.COURSE_NAME 
--write a swl query that counts the number of students whose grade is NULL;

SELECT COUNT(GRADE) FROM ENROLLED_TABLE WHERE GRADE = NULL GROUP BY GRADE;

--delete all table 
DROP TABLE ENROLLED_TABLE;
DROP TABLE STUDENT_TABLE;
DROP TABLE COURSE_TABLE;