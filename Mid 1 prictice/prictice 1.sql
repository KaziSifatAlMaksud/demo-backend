-- SUTABDI'S PROBLEM
--STUDENT TABLE
CREATE TABLE STUDENT_TABLE(STUDENT_ID VARCHAR2(4),STUDENT_NAME VARCHAR2(30));

INSERT INTO STUDENT_TABLE VALUES ('7007','JAMES BOND');
INSERT INTO STUDENT_TABLE VALUES ('1313','SUSAN BROWH');
INSERT INTO STUDENT_TABLE VALUES ('5050','SUSAN SMITH');
INSERT INTO STUDENT_TABLE VALUES ('8989','MAGAN BLACK');
--MODIFY THE PRIMARY KEY

ALTER TABLE STUDENT_TABLE ADD CONSTRAINT STUDENT_PK PRIMARY KEY (STUDENT_ID);

--COURSE TABLE 
CREATE TABLE COURSE_TABLE(COURSE_ID VARCHAR2(7), COUR_NAME VARCHAR2(30), NOOFPTS NUMBER);

INSERT INTO COURSE_TABLE VALUES ('COMP302','DATA SYSTEMS',15);
INSERT INTO COURSE_TABLE VALUES ('COMP203','COMPUTER ORGANIZATION',22);
INSERT INTO COURSE_TABLE VALUES ('COMP206','PROGRAM AND DATA STRUCTURES',22);
INSERT INTO COURSE_TABLE VALUES ('COMP442','ISSUES IN DATABASE',15);

ALTER TABLE COURSE_TABLE ADD CONSTRAINT COURSE_PK PRIMARY KEY (COURSE_ID);
--ENROLLED_TABLE
CREATE TABLE ENROLLED_TABLE ( STUDENT_ID VARCHAR2(4),COURSE_ID VARCHAR2(7), GRADE VARCHAR2(2),
CONSTRAINT STUDENT_FK FOREIGN KEY (STUDENT_ID) REFERENCES STUDENT_TABLE,
CONSTRAINT COURSE_FK FOREIGN KEY (COURSE_ID) REFERENCES COURSE_TABLE);

INSERT INTO ENROLLED_TABLE VALUES ('7007','COMP203','A+');
INSERT INTO ENROLLED_TABLE VALUES ('7007','COMP206','A+');
INSERT INTO ENROLLED_TABLE VALUES ('7007','COMP302','A+');
INSERT INTO ENROLLED_TABLE VALUES ('7007','COMP442',NULL);
INSERT INTO ENROLLED_TABLE VALUES ('1313','COMP203','A');
INSERT INTO ENROLLED_TABLE VALUES ('1313','COMP302','B+');
INSERT INTO ENROLLED_TABLE VALUES ('5050','COMP203','C+');
INSERT INTO ENROLLED_TABLE VALUES ('1313','COMP442',NULL);

-- WRITE A RELATIONAL ALGREBRAIC EXPRESSION THAT WILL RETURN THE STUDENT NAMES ALONG WITH THE COURSE NAME WHICH THEY HAVE ENROLLED.
SELECT STUDENT_NAME,COUR_NAME
FROM STUDENT_TABLE NATURAL JOIN ENROLLED_TABLE NATURAL JOIN COURSE_TABLE;

--write a sql query that returns the name of the course which is not enrolled by any students.

--write a swl query that counts the number of students whose grade is NULL;

SELECT COUNT(*)-COUNT(GRADE) AS NULL_VALUE FROM ENROLLED_TABLE;

--delete all table 
DROP TABLE ENROLLED_TABLE;
DROP TABLE STUDENT_TABLE;
DROP TABLE COURSE_TABLE;

-- Ans to the qustion 6

CREATE TABLE RELATION1(A VARCHAR2(2), B VARCHAR2(2),C VARCHAR2(2),D VARCHAR2(2));

CREATE TABLE RELATION2(D VARCHAR2(2),E VARCHAR2(2),F VARCHAR2(2));

INSERT INTO RELATION1 VALUES('A1','B1','C1','D1');
INSERT INTO RELATION1 VALUES('A2','B2','C2','D2');
INSERT INTO RELATION1 VALUES('A4','B2','C3','D2');
INSERT INTO RELATION1 VALUES('A3','B3','C4','D2');
INSERT INTO RELATION1 VALUES('A5','B3','C5','D1');


INSERT INTO RELATION2 VALUES('D1','E1','F1');
INSERT INTO RELATION2 VALUES('D3','E2','F1');
INSERT INTO RELATION2 VALUES('D2','E3','F1');
INSERT INTO RELATION2 VALUES('D4','E2','F3');

SELECT *
FROM RELATION1 NATURAL JOIN RELATION2;

/*
D  A  B  C  E  F
-- -- -- -- -- --
D1 A1 B1 C1 E1 F1
D2 A2 B2 C2 E3 F1
D2 A4 B2 C3 E3 F1
D2 A3 B3 C4 E3 F1
D1 A5 B3 C5 E1 F1

*/

SELECT *
FROM RELATION1 RIGHT JOIN RELATION2 ON RELATION1.D = RELATION2.D;

/*
A  B  C  D  D  E  F
-- -- -- -- -- -- --
A1 B1 C1 D1 D1 E1 F1
A2 B2 C2 D2 D2 E3 F1
A4 B2 C3 D2 D2 E3 F1
A3 B3 C4 D2 D2 E3 F1
A5 B3 C5 D1 D1 E1 F1
            D3 E2 F1
            D4 E2 F3

7 rows selected.*/